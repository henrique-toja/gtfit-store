<script src="products.js" defer></script>
<script src="combos.js" defer></script>
<script defer>
    document.addEventListener('DOMContentLoaded', () => {
        const appContainer = document.getElementById('app-container');
        const chatBubble = document.querySelector('.chat-bubble'); // Seleciona a bolha do chat

        // Garante que a bolha de chat esteja visível ao carregar a página
        if (chatBubble) {
            chatBubble.style.display = 'block';
        }

        // Verifica se os objetos do namespace existem
        if (!window.gabiFitApp || !window.gabiFitApp.initializeProductShowcase || !window.gabiFitApp.initializeComboFlow) {
            appContainer.innerHTML = '<p class="text-center text-red-500">Erro ao carregar os módulos da aplicação. Verifique os arquivos products.js e combos.js.</p>';
            return;
        }

        // --- Controlador Principal da Navegação SPA ---
        appContainer.addEventListener('showcaseRendered', () => {
            const showCombosButton = document.getElementById('show-combos-flow');
            if (showCombosButton) {
                showCombosButton.addEventListener('click', () => {
                    window.gabiFitApp.initializeComboFlow(appContainer);
                });
            }
        });

        // Inicia a aplicação renderizando a vitrine de produtos
        window.gabiFitApp.initializeProductShowcase(appContainer);
    });
</script>
